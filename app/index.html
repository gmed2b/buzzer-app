<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Buzzer app</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>
<body>
    <div class="navbar">
        <div class="left">
            <h3>
                Status : <span id="ws-status"></span>
            </h3>
        </div>
        <div class="right">
            <a href="" id="admin-btn" class="btn">ADMIN</a>
        </div>
    </div>

    <div class="container">
	    <input id="pseudo" type="text">
        <button id="buzzer-btn" class="btn" disabled>
            BUZZER
        </button>
    </div>

   <script src="https://cdn.socket.io/4.4.0/socket.io.min.js" integrity="sha384-1fOn6VtTq3PWwfsOrk45LnYcGosJwzMHv+Xh/Jx5303FVOXzEnw0EpLv30mtjmlj" crossorigin="anonymous"></script>
    <script>
        const socket = io("ws://med.gmcweb.fr:8080");
        let wsStatus = document.querySelector("#ws-status");
        let buzzerBtn = document.querySelector("#buzzer-btn");
        let adminBtn = document.querySelector("#admin-btn");
	let pseudo = document.querySelector("#pseudo");

        adminBtn.addEventListener('click', (e) => {
		e.preventDefault();
            io.emit('enabledBuzzer', true); 
        });

	buzzerBtn.addEventListener('click', () => {
		io.emit('buzz', pseudo.value);
	});
	
socket.on('connect', () => {
            
            socket.on('enabledBuzzer', (data) => {
                buzzerBtn.disabled = false;
            });

            socket.on('buzz', (data) => {
                console.log(data);
            });

        });

    </script>
</body>
</html>
